---
title: "R SQL"
output: html_notebook
---

```{r}
con = dbConnect(pg, user="kthomas1", password="",
                host="localhost", port=5432, dbname="nfldb")
```

# Basics

```{sql, connection=con}
select name from team;
select distinct pos_team from play;
select full_name from player where team='CAR' and position='QB';
select full_name from player where not team='NE' and position='K';
select full_name from player where team='CAR' and position='QB' and years_pro is not null order by years_pro desc
```

# Next Steps

```{sql, connection=con}
select full_name, position, team, weight from player where full_name is not null and position != 'UNK' order by weight desc limit 10;
select full_name, position, team from player where full_name in('Cam Newton', 'Tom Brady');
select full_name, position, team, years_pro from player where years_pro between 9 and 10;
select min(weight) as smallest from player where team!='UNK' and position!='UNK' and full_name is not null;
select avg(weight) as average from player where team!='UNK' and position!='UNK' and full_name is not null
```

```{sql, connection=con}
select full_name, team, position from player where full_name like 'Kyle%';
select full_name, team, position from player where full_name like '%Thomas' and team != 'UNK'
```

# Grouping


```{sql, connection=con}
select position, team, avg(weight) as weight 
from player 
group by position, team 
order by weight desc;

select position, team, avg(weight) as weight 
from player 
where full_name like 'Kyle%'
group by position, team 
order by weight desc;


```


this doesn't work???
select position, team, avg(weight) as weight 
from player 
group by position, team 
having position like 'O%'

HAVING

EXISTS

ANY/ALL


# Joining Data
inner, left, right, full, self?, union


# Creating DBs and tables
insert into

```{sql, connection=con}
create table injured_reserve (
    name varchar(255),
    team varchar(5),
    position varchar(3),
    weight int,
    height int
)
```

```{sql, connection=con}
alter table injured_reserve add height int;
```

```{sql, connection=con}
alter table injured_reserve drop column height
```

```{sql, connection=con}
drop table injured_reserve
```

```{sql, connection=con}
create table injured_reserve as
    select full_name, team, position, weight, height 
    from player
    where status='InjuredReserve' and full_name!='UNK' and team!='UNK'
```

select into
insert into select


## Constraints
not null, unique, primary key, foreign key, check, default, index

# Questions

Who has the biggest line 

```{r}

```

